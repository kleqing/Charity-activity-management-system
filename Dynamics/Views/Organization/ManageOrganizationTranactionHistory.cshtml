@using Dynamics.Utility
@using Newtonsoft.Json
@inject IHttpContextAccessor Accessor
@model IEnumerable<Dynamics.Models.Models.UserToOrganizationTransactionHistory>


@{
    ViewData["Title"] = "ManageOrganizationTranactionHistory";
    Layout = "_LayoutOrganizationForm";
}

@{
    var OrganizationToProjectHistorys = Accessor.HttpContext.Session.Get<List<OrganizationToProjectHistory>>(MySettingSession.SESSION_OrganizzationToProjectHistory_For_Organization_Key);
}

<div class="py-5 pt-12 px-5 flex justify-center">
    <div class="border border-solid border-gray-500 rounded-box px-5 py-5 w-auto">
        <h1 class="text-3xl font-semibold mb-4 text-center ">
            <span class="border-b-2 border-gray-500 border-solid py-2">Organization Transaction History</span>
        </h1>

        <div class="py-5">
            <div class="max-w-2xl mx-auto space-y-4">
               
                @foreach (var item in OrganizationToProjectHistorys)
                {
                    <!-- Negative Manual Transaction -->
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <div class="flex items-start justify-between mb-2">
                            <div class="flex items-center">
                                <img src="@item.ProjectResource.Project.Attachment" alt="User avatar"
                                     class="w-12 h-12 rounded-full mr-4 border-2 border-gray-200">
                                <div>
                                    <h2 class="text-lg font-semibold">@item.ProjectResource.Project.ProjectName</h2>
                                    <p class="text-sm text-gray-500">Donated on @item.Time</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-lg font-bold text-red-500">- @item.Amount @item.ProjectResource.ResourceName @item.OrganizationResource.Unit</p>
                                <span class="bg-orange-100 text-orange-800 text-xs font-medium px-3 py-1 rounded-full">Processing</span>
                            </div>
                        </div>
                        <p class="text-gray-700 mt-2">Spent @item.ProjectResource.ResourceName to project @item.ProjectResource.Project.ProjectName</p>
                    </div>
                }
                @foreach(var item in Model)
                {
                    <!-- Positive Automatic Transaction -->
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <div class="flex items-start justify-between mb-2">
                            <div class="flex items-center">
                                <img src="@(item.User.UserAvatar)" alt="User avatar"
                                     class="w-12 h-12 rounded-full mr-4 border-2 border-gray-200">
                                <div>
                                    <h2 class="text-lg font-semibold">@(item.User.UserFullName)</h2>
                                    <p class="text-sm text-gray-500">@item.Time</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-lg font-bold text-green-500">+ @item.Amount @item.OrganizationResource.Unit @(item.OrganizationResource.ResourceName)</p>
                                <span class="bg-green-100 text-green-800 text-xs font-medium px-3 py-1 rounded-full">Automatic</span>
                            </div>
                        </div>
                        <p class="text-gray-700 mt-2">@item.Message</p>
                    </div>
                }
               
            </div>

        </div>


    </div>
</div>